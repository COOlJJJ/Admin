{"remainingRequest":"D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\node_modules\\babel-loader\\lib\\index.js!D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\src\\utils\\request.js","dependencies":[{"path":"D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\src\\utils\\request.js","mtime":1649429313615},{"path":"D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\babel.config.js","mtime":1648119135000},{"path":"D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\UserData\\Z0047YMR\\Documents\\GitHub\\Admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IE1lc3NhZ2VCb3gsIE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7IC8vIGNyZWF0ZSBhbiBheGlvcyBpbnN0YW5jZQoKdmFyIHNlcnZpY2UgPSBheGlvcy5jcmVhdGUoewogIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEkgLy8gdXJsID0gYmFzZSB1cmwgKyByZXF1ZXN0IHVybAogIC8vIHdpdGhDcmVkZW50aWFsczogdHJ1ZSwgLy8gc2VuZCBjb29raWVzIHdoZW4gY3Jvc3MtZG9tYWluIHJlcXVlc3RzCiAgLy8gdGltZW91dDogNTAwMCAvLyByZXF1ZXN0IHRpbWVvdXQKCn0pOyAvLyByZXF1ZXN0IGludGVyY2VwdG9yCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgLy8gZG8gc29tZXRoaW5nIGJlZm9yZSByZXF1ZXN0IGlzIHNlbnQKICBpZiAoc3RvcmUuZ2V0dGVycy50b2tlbikgewogICAgY29uZmlnLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJyArIGdldFRva2VuKCk7CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAvLyBkbyBzb21ldGhpbmcgd2l0aCByZXF1ZXN0IGVycm9yCiAgY29uc29sZS5sb2coZXJyb3IpOyAvLyBmb3IgZGVidWcKCiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7IC8vIHJlc3BvbnNlIGludGVyY2VwdG9yCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgdmFyIHJlcyA9IHJlc3BvbnNlLmRhdGE7CgogIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgewogICAgTWVzc2FnZSh7CiAgICAgIG1lc3NhZ2U6IHJlcy5tc2cgfHwgJ0Vycm9yJywKICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgZHVyYXRpb246IDUgKiAxMDAwCiAgICB9KTsKICB9CgogIHJldHVybiByZXM7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIC8vIDUwMDA4OiBJbGxlZ2FsIHRva2VuOyA1MDAxMjogT3RoZXIgY2xpZW50cyBsb2dnZWQgaW47IDUwMDE0OiBUb2tlbiBleHBpcmVkOwogIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT0gNDAxKSB7CiAgICAvLyB0byByZS1sb2dpbgogICAgTWVzc2FnZUJveC5jb25maXJtKCdZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQsIHlvdSBjYW4gY2FuY2VsIHRvIHN0YXkgb24gdGhpcyBwYWdlLCBvciBsb2cgaW4gYWdhaW4nLCAnQ29uZmlybSBsb2dvdXQnLCB7CiAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnUmUtTG9naW4nLAogICAgICBjYW5jZWxCdXR0b25UZXh0OiAnQ2FuY2VsJywKICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgc3RvcmUuZGlzcGF0Y2goJ3VzZXIvcmVzZXRUb2tlbicpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgY29uc29sZS5sb2coJ2VycicgKyBlcnJvcik7IC8vIGZvciBkZWJ1ZwogIC8vIE1lc3NhZ2UoewogIC8vICAgbWVzc2FnZTogZXJyb3IsCiAgLy8gICB0eXBlOiAnZXJyb3InLAogIC8vICAgZHVyYXRpb246IDUgKiAxMDAwCiAgLy8gfSkKCiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7CmV4cG9ydCBkZWZhdWx0IHNlcnZpY2U7"},{"version":3,"sources":["D:/UserData/Z0047YMR/Documents/GitHub/Admin-master/src/utils/request.js"],"names":["axios","MessageBox","Message","store","getToken","service","create","baseURL","process","env","VUE_APP_BASE_API","interceptors","request","use","config","getters","token","headers","error","console","log","Promise","reject","response","res","data","status","message","msg","type","duration","confirm","confirmButtonText","cancelButtonText","then","dispatch","location","reload"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,EAAqBC,OAArB,QAAoC,YAApC;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,QAAT,QAAyB,cAAzB,C,CAEA;;AACA,IAAMC,OAAO,GAAGL,KAAK,CAACM,MAAN,CAAa;AAC3BC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,gBADM,CACY;AACvC;AACA;;AAH2B,CAAb,CAAhB,C,CAMA;;AACAL,OAAO,CAACM,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CACE,UAAAC,MAAM,EAAI;AACR;AACA,MAAIX,KAAK,CAACY,OAAN,CAAcC,KAAlB,EAAyB;AACvBF,IAAAA,MAAM,CAACG,OAAP,CAAe,eAAf,IAAkC,YAAYb,QAAQ,EAAtD;AACD;;AACD,SAAOU,MAAP;AACD,CAPH,EAQE,UAAAI,KAAK,EAAI;AACP;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,EAFO,CAEY;;AACnB,SAAOG,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP;AACD,CAZH,E,CAeA;;AACAb,OAAO,CAACM,YAAR,CAAqBY,QAArB,CAA8BV,GAA9B,CACE,UAAAU,QAAQ,EAAI;AACV,MAAMC,GAAG,GAAGD,QAAQ,CAACE,IAArB;;AAEA,MAAID,GAAG,CAACE,MAAJ,IAAc,GAAlB,EAAuB;AACrBxB,IAAAA,OAAO,CAAC;AACNyB,MAAAA,OAAO,EAAEH,GAAG,CAACI,GAAJ,IAAW,OADd;AAENC,MAAAA,IAAI,EAAE,OAFA;AAGNC,MAAAA,QAAQ,EAAE,IAAI;AAHR,KAAD,CAAP;AAKD;;AACD,SAAON,GAAP;AACD,CAZH,EAaE,UAAAN,KAAK,EAAI;AACP;AACA,MAAIA,KAAK,CAACK,QAAN,CAAeG,MAAf,IAAyB,GAA7B,EAAkC;AAChC;AACAzB,IAAAA,UAAU,CAAC8B,OAAX,CAAmB,gFAAnB,EAAqG,gBAArG,EAAuH;AACrHC,MAAAA,iBAAiB,EAAE,UADkG;AAErHC,MAAAA,gBAAgB,EAAE,QAFmG;AAGrHJ,MAAAA,IAAI,EAAE;AAH+G,KAAvH,EAIGK,IAJH,CAIQ,YAAM;AACZ/B,MAAAA,KAAK,CAACgC,QAAN,CAAe,iBAAf,EAAkCD,IAAlC,CAAuC,YAAM;AAC3CE,QAAAA,QAAQ,CAACC,MAAT;AACD,OAFD;AAGD,KARD;AASD;;AACDlB,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAQF,KAApB,EAdO,CAcoB;AAC3B;AACA;AACA;AACA;AACA;;AACA,SAAOG,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP;AACD,CAlCH;AAqCA,eAAeb,OAAf","sourcesContent":["import axios from 'axios'\nimport { MessageBox, Message } from 'element-ui'\nimport store from '@/store'\nimport { getToken } from '@/utils/auth'\n\n// create an axios instance\nconst service = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API, // url = base url + request url\n  // withCredentials: true, // send cookies when cross-domain requests\n  // timeout: 5000 // request timeout\n})\n\n// request interceptor\nservice.interceptors.request.use(\n  config => {\n    // do something before request is sent\n    if (store.getters.token) {\n      config.headers['Authorization'] = 'Bearer ' + getToken()\n    }\n    return config\n  },\n  error => {\n    // do something with request error\n    console.log(error) // for debug\n    return Promise.reject(error)\n  }\n)\n\n// response interceptor\nservice.interceptors.response.use(\n  response => {\n    const res = response.data\n\n    if (res.status != 200) {\n      Message({\n        message: res.msg || 'Error',\n        type: 'error',\n        duration: 5 * 1000\n      })\n    }\n    return res\n  },\n  error => {\n    // 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;\n    if (error.response.status == 401) {\n      // to re-login\n      MessageBox.confirm('You have been logged out, you can cancel to stay on this page, or log in again', 'Confirm logout', {\n        confirmButtonText: 'Re-Login',\n        cancelButtonText: 'Cancel',\n        type: 'warning'\n      }).then(() => {\n        store.dispatch('user/resetToken').then(() => {\n          location.reload()\n        })\n      })\n    }\n    console.log('err' + error) // for debug\n    // Message({\n    //   message: error,\n    //   type: 'error',\n    //   duration: 5 * 1000\n    // })\n    return Promise.reject(error)\n  }\n)\n\nexport default service\n"]}]}